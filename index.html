<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ä»•äº‹ã®å¹¸ç¦åº¦è¨ºæ–­</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 2em auto; padding: 0 1em; line-height: 1.6; }
    h2 { margin-top: 2em; }
    .question { margin: 1.2em 0; }
    .result-box { border: 1px solid #ccc; padding: 1em; margin-top: 2em; background: #f9f9f9; }
    .answers { font-size: 0.95em; white-space: pre-wrap; }
    button { padding: 0.5em 1em; font-size: 1em; margin-top: 1em; }
  </style>
</head>
<body>
  <h1>ä»•äº‹ã®å¹¸ç¦åº¦è¨ºæ–­</h1>
  <form id="diagnosticForm">
    <h2>I. 7ã¤ã®å¾³ç›®</h2>
    <div id="virtues"></div>

    <h2>II. 8ã¤ã®æ‚ª</h2>
    <div id="vices"></div>

    <button type="submit">è¨ºæ–­ã™ã‚‹</button>
  </form>

  <div id="result" class="result-box" style="display:none;"></div>
  <button id="downloadImg" style="display:none;">ğŸ“¸ è¨ºæ–­çµæœã‚’ç”»åƒã§ä¿å­˜</button>

  <script>
    const virtues = [
      ["è‡ªç”±", "è‡ªèº«ã®ä»•äº‹ã®å†…å®¹ã‚„é€²ã‚æ–¹ã‚’ã€ã‚ã‚‹ç¨‹åº¦è‡ªç”±ã«æ±ºã‚ã‚‰ã‚Œã‚‹è£é‡æ¨©ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"],
      ["é”æˆ", "ä»•äº‹ã‚’é€šã˜ã¦ç›®æ¨™ã‚’é”æˆã—ãŸã¨æ„Ÿã˜ãŸã‚Šã€å‰é€²ã—ã¦ã„ã‚‹æ„Ÿè¦šãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"],
      ["ç„¦ç‚¹", "ã‚ãªãŸã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—ã«ç¾åœ¨ã®ä»•äº‹ãŒåˆã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"],
      ["æ˜ç¢º", "ä»•äº‹ã®ç›®æ¨™ã‚„è©•ä¾¡åŸºæº–ãŒæ˜ç¢ºã«å®šã¾ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"],
      ["å¤šæ§˜", "ä½œæ¥­å†…å®¹ã«ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã€å˜èª¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ"],
      ["ä»²é–“", "å›°ã£ãŸæ™‚ã«åŠ©ã‘åˆãˆã‚‹ä¿¡é ¼ã§ãã‚‹åŒåƒšãŒã„ã¾ã™ã‹ï¼Ÿ"],
      ["è²¢çŒ®", "è‡ªåˆ†ã®ä»•äº‹ãŒç¤¾ä¼šã‚„ä»–äººã®å½¹ã«ç«‹ã£ã¦ã„ã‚‹ã¨å®Ÿæ„Ÿã§ãã¾ã™ã‹ï¼Ÿ"],
    ];

    const vices = [
      ["ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹å´©å£Š", "ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãŒçŠ ç‰²ã«ãªã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"],
      ["é›‡ç”¨ãŒä¸å®‰å®š", "ç¾åœ¨ã®é›‡ç”¨ã«å¯¾ã—ã¦ä¸å®‰ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ"],
      ["åŠ´åƒæ™‚é–“ãŒé•·ã„", "éåº¦ãªé•·æ™‚é–“åŠ´åƒãŒå¸¸æ…‹åŒ–ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ"],
      ["ã‚·ãƒ•ãƒˆãƒ¯ãƒ¼ã‚¯", "ä¸è¦å‰‡ãªã‚·ãƒ•ãƒˆå‹¤å‹™ã«ã‚ˆã£ã¦å¿ƒèº«ã«è² æ‹…ã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"],
      ["ä»•äº‹ã®è£é‡æ¨©ãŒãªã„", "ä»•äº‹ã®é€²ã‚æ–¹ã«æ±ºå®šæ¨©ãŒãªãã€å¸¸ã«æŒ‡ç¤ºå¾…ã¡ã ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"],
      ["å‘¨å›²ã‹ã‚‰ã®ã‚µãƒãƒ¼ãƒˆãŒãªã„", "è·å ´ã§å­¤ç«‹ã—ã€åŠ©ã‘ãŒå¾—ã‚‰ã‚Œãªã„ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"],
      ["çµ„ç¹”å†…ã«ä¸å…¬å¹³ãŒå¤šã„", "è©•ä¾¡ã‚„å ±é…¬ã«ä¸å…¬å¹³ã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ"],
      ["é€šå‹¤æ™‚é–“ãŒé•·ã„", "é€šå‹¤ãŒé•·ãã€ã‚¹ãƒˆãƒ¬ã‚¹ã‚„è² æ‹…ã«æ„Ÿã˜ã¦ã„ã¾ã™ã‹ï¼Ÿ"],
    ];

    function createQuestions(containerId, list, prefix) {
      const container = document.getElementById(containerId);
      list.forEach(([label, question], i) => {
        const index = i + 1;
        const html = `
          <div class="question">
            <strong>${index}. ${label}</strong><br>
            ${question}<br>
            <label><input type="radio" name="${prefix}${index}" value="2" required> ã¯ã„</label>
            <label><input type="radio" name="${prefix}${index}" value="1"> éƒ¨åˆ†çš„ã«å½“ã¦ã¯ã¾ã‚‹</label>
            <label><input type="radio" name="${prefix}${index}" value="0"> ã„ã„ãˆ</label>
          </div>
        `;
        container.insertAdjacentHTML('beforeend', html);
      });
    }

    createQuestions("virtues", virtues, "v");
    createQuestions("vices", vices, "x");

    document.getElementById("diagnosticForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const form = new FormData(this);
      let virtueScore = 0, viceScore = 0;
      let virtueAnswers = "", viceAnswers = "";

      virtues.forEach((item, i) => {
        const val = form.get(`v${i+1}`);
        virtueScore += parseInt(val);
        const text = ["ã„ã„ãˆ", "éƒ¨åˆ†çš„ã«å½“ã¦ã¯ã¾ã‚‹", "ã¯ã„"][val];
        virtueAnswers += `${i+1}. ${item[0]}ï¼š${text}\n`;
      });

      vices.forEach((item, i) => {
        const val = form.get(`x${i+1}`);
        viceScore += parseInt(val);
        const text = ["ã„ã„ãˆ", "éƒ¨åˆ†çš„ã«å½“ã¦ã¯ã¾ã‚‹", "ã¯ã„"][val];
        viceAnswers += `${i+1}. ${item[0]}ï¼š${text}\n`;
      });

      let resultMsg = "";
      if (virtueScore >= 12 && viceScore <= 3) {
        resultMsg = "ğŸ‰ ã‚ãªãŸã®ä»•äº‹ã¯ã¨ã¦ã‚‚å¹¸ç¦åº¦ãŒé«˜ãã€ãƒªã‚¹ã‚¯ã‚‚ä½ã„ç†æƒ³çš„ãªç’°å¢ƒã§ã™ï¼";
      } else if (virtueScore >= 9 && viceScore <= 6) {
        resultMsg = "ğŸ˜Š æ¯”è¼ƒçš„è‰¯å¥½ãªè·å ´ç’°å¢ƒã§ã™ã€‚æ”¹å–„ã®ä½™åœ°ã¯ã‚ã‚Šã¾ã™ãŒã€å®‰å¿ƒã—ã¦å–ã‚Šçµ„ã‚ã¾ã™ã€‚";
      } else if (virtueScore < 7 && viceScore > 8) {
        resultMsg = "âš ï¸ å¹¸ç¦åº¦ãŒä½ãã€ãƒªã‚¹ã‚¯ãŒé«˜ã„è·å ´ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚";
      } else {
        resultMsg = "ğŸ§ ä¸€éƒ¨ã«èª²é¡ŒãŒã‚ã‚Šã¾ã™ãŒã€å…¨ä½“ã¨ã—ã¦ã¯ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚";
      }

      const resultHTML = `
        <h2>è¨ºæ–­çµæœ</h2>
        <p>âœ… å¹¸ç¦åº¦ã‚¹ã‚³ã‚¢ï¼š<strong>${virtueScore} / 14</strong></p>
        <p>âš ï¸ ãƒªã‚¹ã‚¯ã‚¹ã‚³ã‚¢ï¼š<strong>${viceScore} / 16</strong></p>
        <p>${resultMsg}</p>
        <hr>
        <h3>ã‚ãªãŸã®å›ç­”ä¸€è¦§ï¼š</h3>
        <div class="answers"><strong>ã€7ã¤ã®å¾³ç›®ã€‘</strong>\n${virtueAnswers}</div>
        <div class="answers"><strong>ã€8ã¤ã®æ‚ªã€‘</strong>\n${viceAnswers}</div>
      `;

      const resultEl = document.getElementById("result");
      resultEl.innerHTML = resultHTML;
      resultEl.style.display = "block";
      document.getElementById("downloadImg").style.display = "inline-block";
    });

    document.getElementById("downloadImg").addEventListener("click", () => {
      html2canvas(document.getElementById("result")).then(canvas => {
        const link = document.createElement("a");
        link.href = canvas.toDataURL("image/png");
        link.download = "è¨ºæ–­çµæœ.png";
        link.click();
      });
    });
  </script>
</body>
</html>
